<script language='javascript'>
$(document).ready(function(){
  $('#tokyoku').hide();
  $('#oosakaku').hide();
});
function tokyo(){
  $('#tokyoku').show();
  $('#oosakaku').hide();
};
function oosaka(){
  $('#oosakaku').show();
  $('#tokyoku').hide();
};

function sub(){
  if($("#image").val() === null || $("#image").val() == ''){  
    alert("物件イメージは最低一枚登録してください。")
    return false;
  }  
  else if($("#name").val() == null || $("#name").val() == ''){  
    alert("物件名を入力してください。")
    return false;
  }
  else if($("#rent").val() == null || $("#rent").val() == ''){  
    alert("家賃を入力してください。")
    return false;
  }
  else if(!$("#injapanTOKYO").is(':checked') && !$("#injapanOOSAKA").is(':checked')){
    alert("地域を選択してください。"); 
    return false;
  }
  else if($("#longitude").val() == null || $("#longitude").val() == ''){  
    alert("経度を入力してください。")
    return false;
  }
  else if($("#latitude").val() == null || $("#latitude ").val() == ''){  
    alert("緯度を入力してください。")
    return false;
  }
  else if($("#area").val() == null || $("#area").val() == ''){  
    alert("広さを入力してください。")
    return false;
  }
  
  var rent = document.getElementById('rent');
  var longitude = document.getElementById('longitude');
  var latitude = document.getElementById('latitude');
  var area = document.getElementById('area');

  var re = /^[1.0-9.0]+$/;
  if(!re.test(rent.value)) {
    alert("家賃欄に正常数を入れてください。");
    return false;
  }
  else if(!re.test(longitude.value)) {
    alert("経度欄に正常数を入れてください。");
    return false;
  }
  else if(!re.test(latitude.value)) {
    alert("緯度欄に正常数を入れてください。");
    return false;
  }
  else if(!re.test(area.value)) {
    alert("広さ欄に正常数を入れてください。");
    return false;
  }
  if($('#injapanTOKYO').is(':checked')) {
    $('#oosakaku').remove();
    return true;
  }
  else if($('#injapanOOSAKA').is(':checked')){
    $('#tokyoku').remove();
    return true;
  }
};
function GooglemapGuide(){
  var googlemap_dic = './googlemap.html'
  <% unless @propertys.id == nil %>
    googlemap_dic = '../googlemap.html'
  <% end %>
  window.open( googlemap_dic ,'','width=790, height=800,scrollbars=yes,toolbar=no,menubar=no,status=no,resizable=yes')
}
</script>
<% if @propertys.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@propertys.errors.count, "error") %> prohibited this @user from being saved:</h2>
    <ul>
    <% @propertys.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>
<%= form_with(model: @propertys, local: true, url: choose_new_or_edit, name: "Form") do |f| %>
<table>
    <tr>
      <td ropspan ='2'><%= f.label :物件イメージ %></td>
      <% if @propertys.image.present? %>
        <% @propertys.image.each do |image| %>
          <th><%= image_tag (image.url)%></th>
        <% end %>
      <% end %>
        <td><%= f.file_field :image, :multiple => true, :value => @propertys.image, :id => "image" %></td>
    </tr>
    <tr>
      <td ropspan ='2'><%= f.label :内部ビデオ %></td>
      <% if @propertys.video.present? %>
        <th><%= video_tag @propertys.video.url, autoplay: true, muted: true, controls: true , :size => "350x260"%></th>
      <% else %>
        <td><%= f.file_field :video, :multiple => false, :value => @propertys.video %></td>
      <% end %>
    </tr>
    <tr>
      <td><%= f.label :物件名 %></td>
      <td><%= f.text_field :name, :value => @propertys.name, :id => "name" %></td>
    </tr>
    <tr>
      <td><%= f.label :家賃 %></td>
      <td><%= f.text_field :rent, :value => @propertys.rent , :id => "rent" %></td>
    </tr>
    <tr>
      <td><%= f.label :敷金 %></td>
      <td><%= f.select :subsidy, [['なし', 'なし'], ['1っか月', '1っか月'],['2っか月', '2っか月']], :selected => @propertys.subsidy, :value => @propertys.reward  %></td>
    </tr>
    <tr>
      <td><%= f.label :礼金 %></td>
      <td><%= f.select :reward, [['なし', 'なし'], ['1っか月', '1っか月'],['2っか月', '2っか月']], :selected => @propertys.reward, :value => @propertys.reward %></td>
    </tr>
    <tr name='country' id='country'>
      <td><%= f.label :区 %></td>
      <td><input type="radio" onclick='tokyo()' name = "injapan" id = "injapanTOKYO">東京</td>
      <td><input type="radio" onclick='oosaka()' name = "injapan" id = "injapanOOSAKA">大阪</td>
    </tr>
    <tr>
      <td>　</td>
      <td>
        <div id='tokyoku'>
          <%= f.select :region, [['千代田','千代田'],['中央','中央'],['港','港'],['江東','江東'],['新宿','新宿'],['文京','文京'],['大田','大田'],['台東','台東'],['渋谷','渋谷'],['世田谷','世田谷'],['中野','中野'],
            ['品川','品川'],['目黒','目黒'],['墨田','墨田'],['板橋','板橋'],['北','北'],['足立','足立'],['葛飾','葛飾'],['練馬','練馬'],['荒川','荒川'],['杉並','杉並'],['江戸川','江戸川'],['豊島','豊島']], :id => "tokyokuselect",:name => "tokyokuselect" %>
        </div>
      </td>
      <td>
        <div id='oosakaku'>
          <%= f.select :region, [['此花','此花'],['鶴見','鶴見'],['阿倍野','阿倍野'],['旭區','旭區'],['浪速','浪速'],['西','西'],['西成','西成'],['生野','生野'],['城東','城東'],['西成','西成'],['西淀川','西淀川'],['中央','中央'],['福島','福島'],
            ['大正','大正'],['天王寺','天王寺'],['東成','東成'],['東住吉','東住吉'],['都島','都島'],['東淀川','東淀川'],['平野','平野'],['住之江','住之江'],['住吉','住吉']],:id => "oosakakuselect",:name => "oosakakuselect" %>
        </div>
      </td>  
    </tr>
    <tr>
      <td><%= f.label :経度 %></td>
      <td><%= f.text_field :longitude, :value => @propertys.longitude, :id => "longitude" %></td>
      <td><a onclick='GooglemapGuide()'>経緯と緯度とは？</a></td>
    </tr>
    <tr>
      <td><%= f.label :緯度 %></td>
      <td><%= f.text_field :latitude, :value => @propertys.latitude, :id => "latitude" %></td>
    </tr>
    <tr>
      <td><%= f.label :広さ %>(㎡)</td>
      <td><%= f.text_field :area, :value => @propertys.area, :id => "area" %></td>
    </tr>
    <tr>
      <td><%= f.label :間取り %></td>
      <td><%= f.select :extent, [['1R','1R'], ['1K','1K'],['1DK','1DK'],['1LDK','1LDK'],['2K','2K'],['2LDK','2LDK'],['3K','3K'],['3DK','3DK'],['3LDK','3LDK'],['4K','4K']], :selected => @propertys.extent, :value => @propertys.extent %></td>
    </tr>
      <td colspan ='2'>
        <%= f.submit '物件登録', onclick: 'return sub()' %>
      </td>
    </tr>
  </table>
<% end %>

<% if @propertys.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@propertys.errors.count, "error") %> prohibited this @propertys from being saved:</h2>
    <ul>
    <% @propertys.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>
